<div class="text-center mb-4">
    <h3 class="text-info">ลงทะเบียนเจ้าหน้าที่</h3>
</div>
<form id="regForm">
    <div class="mb-3">
        <label class="form-label">ชื่อ-นามสกุล</label>
        <input type="text" class="form-control" id="fullName" required>
    </div>
    <div class="mb-3">
        <label class="form-label">ตำแหน่ง/ฝ่าย</label>
        <select class="form-select" id="position" required>
            <option value="เภสัชกร">เภสัชกร</option>
            <option value="เจ้าพนักงานเภสัชกรรม">เจ้าพนักงานเภสัชกรรม</option>
            <option value="อื่นๆ">อื่นๆ</option>
        </select>
    </div>
    <button type="submit" class="btn btn-info w-100 fw-bold">บันทึกข้อมูล</button>
</form>

<script>
    window.initPageLogic = function(lineId) {
        document.getElementById('regForm').onsubmit = async (e) => {
            e.preventDefault();
            Swal.showLoading();
            const payload = {
                action: 'registerUser',
                userId: lineId,
                name: document.getElementById('fullName').value,
                pos: document.getElementById('position').value
            };
            const response = await fetch(GAS_URL, { method: 'POST', body: JSON.stringify(payload) });
            const result = await response.json();
            if (result.status === 'success') {
                Swal.fire('สำเร็จ', 'ลงทะเบียนเรียบร้อย', 'success').then(() => liff.closeWindow());
            }
        };
    };
</script>
